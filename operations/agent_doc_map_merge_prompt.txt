You are synthesizing multiple prior analyses into a single architecture and operations document for an AI agent.

Workspace context:
- workspace root: {project_root}
- in-scope folder: {scope_display}

Commit metadata for this documentation build:
- created_from_sha (first documentation baseline): {created}

Source references:
{reference_section}

Each finding below comes from a separate map-level analysis pass over the scoped folder. Each finding:
- Already includes inline [N] citations that refer to the source references above.
- May overlap with or contradict other findings.

<<<FINDINGS>>>
{findings_block}
<<<ENDFINDINGS>>>

Your task:
- Read and integrate all findings into a single coherent documentation set suitable for future AI agents that cannot call tools.
- Produce a single markdown document with these exact top-level headings:
  # Agent Doc
  ## 1. Project Identity and Constraints
  ## 2. Architecture Overview
  ## 3. Subsystem Guides
  ## 4. Operations, Commands, and Testing
  ## 5. Known Pitfalls and Debugging Patterns
- Under "Architecture Overview" and "Subsystem Guides", include one or more Mermaid diagrams that make the system structure as clear as possible, covering:
  - Intra-subsystem flows (within a module or package).
  - Inter-subsystem interactions (between modules, services, and entrypoints).
  - Key data flows, boundaries, and external dependencies (e.g., databases, queues, MCP servers).
  - Service call graphs and control flow where helpful.
  Use standard Mermaid syntax (for example: flowchart, sequence diagrams, or class diagrams) and base all diagrams strictly on the findings and source references. To avoid syntax errors:
  - Use simple snake_case node IDs without spaces or punctuation (e.g., `core_db`, `cli_entry`, `mcp_server`).
  - Always write nodes as `id["Human readable label"]` (ID first, then a label in double quotes inside brackets).
  - Put spaces, slashes, and other punctuation only in the label, never in the ID.
  - Do NOT include citation markers like `[3]` or `[N]` inside any Mermaid diagram; keep citations in the surrounding markdown text.
  - Do NOT append extra text after a node label before an edge (avoid patterns like `node\"][3] --> target`).
- Under "Subsystem Guides", group information by natural submodules or packages within the in-scope folder and describe their responsibilities, interactions, extension patterns, and how they appear in the diagrams.
- Integrate all findings, remove duplication, and resolve contradictions; when in doubt, prefer the most precise or conservative description.
- Preserve all existing [N] citations from the findings and keep them attached to the statements they support.
- Do NOT invent new [N] citations or change citation numbers.
- Do NOT mention internal tools such as deep research pipelines, HyDE planning, or map passes; just describe the project based on the analyses.
- Do NOT include a "## Sources" footer; the caller will append it.
- Do NOT include any metadata comment header; only return the markdown body starting from "# Agent Doc".
